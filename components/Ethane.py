import numpy as np

def vapor_pressure(T):
    P_s = (7*10**(-5))*(T**3) - 0.0224*(T**2) + 2.3868*T - 84.871
    return P_s

def density(T):
    LD = 637.5 + 0*T
    return LD

def liq_enthalpy(T):
    x = np.array(T)

    Tmin = -170 + 273.15;
    Tmax = -130 + 273.15;
    x = (x - Tmin) / (Tmax - Tmin);

    Q = len(x)

    x_xoffset = 0.05
    x_gain = 4
    x_ymin = -1

    # Layer 1
    b1 = [[-7.9402287795160839678], [-3.2244637695837043978], [3.737670373465262319], [-0.70759110464759877868], [-1.1227118314895674356],
        [0.27129204192238776105], [-2.0744509402214572624], [0.62898796696122738492], [9.6293213915527200442], [3.3303444525938203924]]
    b1 = np.array(b1)

    IW1_1 = [[7.2276937995113375024], [3.222644446093363868], [-5.7932131639648059007], [0.91160090526463732896], [7.8378391640211830804],
            [3.8275751963433988223], [-6.9741776372266102157], [0.71955145667906150742], [12.584921892327072257], [2.6296594807543414163]]
    IW1_1 = np.array(IW1_1)

    # Layer 2
    b2 = [[-0.21208333349092595155], [1.0176537378027088465]]
    b2 = np.array(b2)

    LW2_1 = [[0.010819146453462892207, 0.034930374749823404901, -0.00038233384967496195387, 0.72021263978136051964,
            7.6242528120389765705*10**(-5), 0.0012354059016870663421, -0.00011132308154420081261, 1.1682634970567662425,
            3.0069925867685728016*10**(-5), 0.051300614742392607048], [0.00096099331854591733826, -0.0052641272697283893189,
            0.0019459501906280991367, 0.0061198775369804203281, 0.0010459267723426039082, 0.0093039298166046544014,
            -0.0034308521525995747635, -1.9715067039200186993, -0.0024849521062834910301, -0.30531752715771492968]]
    LW2_1 = np.array(LW2_1)

    # Output 1
    y1_ymin = -1
    y1_gain = [[4.24648319367447*10**(-5)], [0.0349863442009991]]
    y1_xoffset = [[4792.79641551804], [2339.22823360276]]

    xp1 = [(x[i][0] - x_xoffset) * x_gain + x_ymin for i in range(len(x))]

    a1 = np.empty((len(b1), 0))
    a2 = np.array([])

    for i in range(len(xp1)):
        b3 = b1 + IW1_1*xp1[i]
        a = 2 / (1 + np.exp(-2*b3)) - 1
        a1 = np.append(a1, a, axis=1)

    a2 = np.repeat(b2, Q, axis=1) + np.matmul(LW2_1, a1)

    a3 = a2 - y1_ymin
    a3 = np.divide(a3, y1_gain)
    a3 = a3 + y1_xoffset

    y1 = np.transpose(a3)

    return y1[:,0]

def vap_enthalpy(T):
    x = np.array(T)

    Tmin = -170 + 273.15
    Tmax = -130 + 273.15
    x = (x - Tmin) / (Tmax - Tmin)

    Q = len(x)

    x_xoffset = 0.05
    x_gain = 4
    x_ymin = -1

    # Layer 1
    b1 = [[-11.552177085744270713], [-9.7181878089745037386], [-5.0914340640451207776], [4.2533089182999148647],
        [-1.040138075187520883],
        [-21.295104853466106931], [0.17158873836762447707], [7.0743806263191695294], [7.5505910328477252591],
        [-17.144258266353340048]]
    b1 = np.array(b1)

    IW1_1 = [[11.543477428827204179], [11.002802968908429904], [6.6155274440597073848], [-7.5920669446234727573],
            [1.2901573215125679006],
            [-182.08025666488339311], [0.27344473204560021395], [10.899837088513560701], [8.8918233086963009981],
            [-17.692595220380059828]]
    IW1_1 = np.array(IW1_1)

    # Layer 2
    b2 = [[-0.52565358264899531004], [-0.50206453725675848077]]
    b2 = np.array(b2)

    LW2_1 = [[0.0058256312421214673583, 0.0022656993331152401779, 0.0036700473033542918393, -0.00051605029340631139358,
            0.099849422901760478966, -8.1672653041630954087e-06, 3.5756628077713670244, 0.00015150831463868190299,
            0.00075810982871767984906, -0.00055559573855416951801],
            [0.0089012898041524700365, 0.0010328237895090299717,
            0.0046007193096992441902, 0.00095518822604149903905, 0.12631904208074767881, -0.00074507760374932540445,
            3.4985287090533119247, 0.0024581869179151854925, 0.0014596763242494086021, -0.0014531213881480722037]]
    LW2_1 = np.array(LW2_1)

    # Output 1
    y1_ymin = -1
    y1_gain = [[8.25232457706449 * 10 ** (-5)], [0.0484487820623466]]
    y1_xoffset = [[585338.40937719], [1201.63685145923]]

    xp1 = [(x[i][0] - x_xoffset) * x_gain + x_ymin for i in range(len(x))]

    a1 = np.empty((len(b1), 0))
    a2 = np.array([])

    for i in range(len(xp1)):
        b3 = b1 + IW1_1 * xp1[i]
        a = 2 / (1 + np.exp(-2 * b3)) - 1
        a1 = np.append(a1, a, axis=1)

    a2 = np.repeat(b2, Q, axis=1) + np.matmul(LW2_1, a1)

    a3 = a2 - y1_ymin
    a3 = np.divide(a3, y1_gain)
    a3 = a3 + y1_xoffset

    y1 = np.transpose(a3)

    return y1[:, 1]

def liq_heat_capacity(T):
    x = np.array(T)

    Tmin = -170 + 273.15
    Tmax = -130 + 273.15
    x = (x - Tmin) / (Tmax - Tmin)

    Q = len(x)

    x_xoffset = 0.05
    x_gain = 4
    x_ymin = -1

    # Layer 1
    b1 = [[-7.9402287795160839678], [-3.2244637695837043978], [3.737670373465262319], [-0.70759110464759877868], [-1.1227118314895674356],
        [0.27129204192238776105], [-2.0744509402214572624], [0.62898796696122738492], [9.6293213915527200442], [3.3303444525938203924]]
    b1 = np.array(b1)

    IW1_1 = [[7.2276937995113375024], [3.222644446093363868], [-5.7932131639648059007], [0.91160090526463732896], [7.8378391640211830804],
            [3.8275751963433988223], [-6.9741776372266102157], [0.71955145667906150742], [12.584921892327072257], [2.6296594807543414163]]
    IW1_1 = np.array(IW1_1)

    # Layer 2
    b2 = [[-0.21208333349092595155], [1.0176537378027088465]]
    b2 = np.array(b2)

    LW2_1 = [[0.010819146453462892207, 0.034930374749823404901, -0.00038233384967496195387, 0.72021263978136051964,
            7.6242528120389765705*10**(-5), 0.0012354059016870663421, -0.00011132308154420081261, 1.1682634970567662425,
            3.0069925867685728016*10**(-5), 0.051300614742392607048], [0.00096099331854591733826, -0.0052641272697283893189,
            0.0019459501906280991367, 0.0061198775369804203281, 0.0010459267723426039082, 0.0093039298166046544014,
            -0.0034308521525995747635, -1.9715067039200186993, -0.0024849521062834910301, -0.30531752715771492968]]
    LW2_1 = np.array(LW2_1)

    # Output 1
    y1_ymin = -1
    y1_gain = [[4.24648319367447*10**(-5)], [0.0349863442009991]]
    y1_xoffset = [[4792.79641551804], [2339.22823360276]]

    xp1 = [(x[i][0] - x_xoffset) * x_gain + x_ymin for i in range(len(x))]

    a1 = np.empty((len(b1), 0))
    a2 = np.array([])

    for i in range(len(xp1)):
        b3 = b1 + IW1_1*xp1[i]
        a = 2 / (1 + np.exp(-2*b3)) - 1
        a1 = np.append(a1, a, axis=1)

    a2 = np.repeat(b2, Q, axis=1) + np.matmul(LW2_1, a1)

    a3 = a2 - y1_ymin
    a3 = np.divide(a3, y1_gain)
    a3 = a3 + y1_xoffset

    y1 = np.transpose(a3)

    return y1[:, 1]

def vap_heat_capacity(T):
    x = np.array(T)

    Tmin = -170 + 273.15
    Tmax = -130 + 273.15
    x = (x - Tmin) / (Tmax - Tmin)

    Q = len(x)

    x_xoffset = 0.05
    x_gain = 4
    x_ymin = -1

    # Layer 1
    b1 = [[-11.552177085744270713], [-9.7181878089745037386], [-5.0914340640451207776], [4.2533089182999148647],
        [-1.040138075187520883],
        [-21.295104853466106931], [0.17158873836762447707], [7.0743806263191695294], [7.5505910328477252591],
        [-17.144258266353340048]]
    b1 = np.array(b1)

    IW1_1 = [[11.543477428827204179], [11.002802968908429904], [6.6155274440597073848], [-7.5920669446234727573],
            [1.2901573215125679006],
            [-182.08025666488339311], [0.27344473204560021395], [10.899837088513560701], [8.8918233086963009981],
            [-17.692595220380059828]]
    IW1_1 = np.array(IW1_1)

    # Layer 2
    b2 = [[-0.52565358264899531004], [-0.50206453725675848077]]
    b2 = np.array(b2)

    LW2_1 = [[0.0058256312421214673583, 0.0022656993331152401779, 0.0036700473033542918393, -0.00051605029340631139358,
            0.099849422901760478966, -8.1672653041630954087e-06, 3.5756628077713670244, 0.00015150831463868190299,
            0.00075810982871767984906, -0.00055559573855416951801],
            [0.0089012898041524700365, 0.0010328237895090299717,
            0.0046007193096992441902, 0.00095518822604149903905, 0.12631904208074767881, -0.00074507760374932540445,
            3.4985287090533119247, 0.0024581869179151854925, 0.0014596763242494086021, -0.0014531213881480722037]]
    LW2_1 = np.array(LW2_1)

    # Output 1
    y1_ymin = -1
    y1_gain = [[8.25232457706449 * 10 ** (-5)], [0.0484487820623466]]
    y1_xoffset = [[585338.40937719], [1201.63685145923]]

    xp1 = [(x[i][0] - x_xoffset) * x_gain + x_ymin for i in range(len(x))]

    a1 = np.empty((len(b1), 0))
    a2 = np.array([])

    for i in range(len(xp1)):
        b3 = b1 + IW1_1 * xp1[i]
        a = 2 / (1 + np.exp(-2 * b3)) - 1
        a1 = np.append(a1, a, axis=1)

    a2 = np.repeat(b2, Q, axis=1) + np.matmul(LW2_1, a1)

    a3 = a2 - y1_ymin
    a3 = np.divide(a3, y1_gain)
    a3 = a3 + y1_xoffset

    y1 = np.transpose(a3)

    return y1[:, 1]